1.5  ACCESSING DATABASE: (SUBQUERY)

1.    List the customer names of invoice date 3rd February 2023.

 mysql>  SELECT name FROM Customer WHERE id IN (SELECT id FROM INVOICE_MASTER WHERE inv_date='2023-03-15');
+------+
| name |
+------+
| vysh |
+------+
1 row in set (0.01 sec)

2.    List the product name and price of each invoice item.

mysql> SELECT pname ,price from Product where pid in(select pid from INVOICE_ITEM);
+-------+-------+
| pname | price |
+-------+-------+
| pen   |   102 |
| ball  |    41 |
+-------+-------+
2 rows in set (0.00 sec)

3.    List the product names, only include their purchased quantity more than 20.

mysql> SELECT pname from Product where pid in(select pid from INVOICE_ITEM WHERE quantity >20);
+-------+
| pname |
+-------+
| pen   |
+-------+
1 row in set (0.00 sec)


4.    Find the product that has no sale.

mysql> SELECT * from Product where pid NOT  in(select pid from INVOICE_ITEM);
+-----+--------+-------+
| pid | pname  | price |
+-----+--------+-------+
|  12 | book   |    51 |
|  14 | pencil |    51 |
|  15 | box    |   102 |
|  16 | bat    |   612 |
|  18 | baloon |    31 |
+-----+--------+-------+
5 rows in set (0.00 sec)

5.    List the customer names who purchased the items ‘pen’ and ‘pencil’.


6.    Display the purchased product details of the customer ’xyz’.

mysql> SELECT * FROM Product WHERE pid IN(SELECT pid FROM INVOICE_ITEM WHERE inv_id IN(SELECT inv_id FROM INVOICE_MASTER WHERE id IN(SELECT id FROM Customer WHERE name='kichu')));
+-----+-------+-------+
| pid | pname | price |
+-----+-------+-------+
|  17 | ball  |    41 |
+-----+-------+-------+
1 row in set (0.00 sec)


7.    List the names of all customers who have purchased at least 2 products, make sure that no duplicate names in the result.

mysql>  SELECT DISTINCT name FROM Customer WHERE id IN(SELECT id FROM INVOICE_MASTER WHERE inv_id IN (SELECT inv_id FROM INVOICE_ITEM GROUP BY inv_id HAVING COUNT(*)>1));
+---------+
| name    |
+---------+
| akshara |
+---------+
1 row in set (0.00 sec)
